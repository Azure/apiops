name: Run Publisher with Environment

on:
  workflow_dispatch:
    inputs:
      API_MANAGEMENT_ENVIRONMENT:
        description: 'Choose the environment to deploy to.'
        required: true
        type: choice
        options:
          - dev
          - prod
      API_MANAGEMENT_SERVICE_OUTPUT_FOLDER_PATH:
        description: 'The path to the artifacts folder.'
        required: true
        type: string
        default: 'api_migration/apiops/apimartifacts'

env:
  apiops_release_version: v6.0.1.7
  Logging__LogLevel__Default: ${{ vars.LOG_LEVEL || 'Information' }}

jobs:
  build:
    runs-on: ubuntu-latest
    environment: ${{ inputs.API_MANAGEMENT_ENVIRONMENT }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 2
    
      # The rest of the steps (Spectral, Token Replace, Publisher runs)
      # will now correctly use the updated default path from the input.
      # No changes are needed in the individual steps below.
      # ... (rest of the publisher workflow)
